"use strict";!function(){function o(o){var e=r(o.data);switch(e.method){case"gpio.export":navigator.mozGpio["export"](e.portNumber),postMessage(i({method:e.method+"."+e.portNumber,portNumber:e.portNumber}));break;case"gpio.setDirection":navigator.mozGpio.setDirection(e.portNumber,e.direction),e.direction?t=t.filter(function(o){return e.portNumber!==o.portNumber}):t.push({portNumber:e.portNumber,value:void 0});break;case"gpio.setValue":navigator.mozGpio.setValue(e.portNumber,e.value);break;case"gpio.getValue":navigator.mozGpio.getValue(e.portNumber).then(function(o){postMessage(i({method:e.method+"."+e.portNumber,portNumber:e.portNumber,value:o}))});break;default:throw"Unexpected case to worker method"}}navigator.mozGpio||(navigator.mozGpio=new Object,navigator.mozGpio.direction="",navigator.mozGpio.value=0,navigator.mozGpio["export"]=function(o){},navigator.mozGpio.unexport=function(o){},navigator.mozGpio.setValue=function(o,e){console.log("setValue("+o+","+e+")")},navigator.mozGpio.getValue=function(o){return navigator.mozGpio.value},navigator.mozGpio.setDirection=function(o,e){console.log("setDirection("+o+","+e+")"),navigator.mozGpio.direction=e},navigator.mozGpio.getDirection=function(){return navigator.mozGpio.direction});var e=function(){t.forEach(function(o){Promise.resolve(navigator.mozGpio.getValue(o.portNumber)).then(function(e){parseInt(o.value)!==parseInt(e)&&(o.value=e,postMessage(i({method:"gpio.onchange."+o.portNumber,portNumber:o.portNumber,value:e})))})})},t=[];setInterval(e,30);onmessage=o;var r=function(o){return JSON.parse(String.fromCharCode.apply(null,new Uint16Array(o)))},i=function(o){for(var e=JSON.stringify(o),t=new ArrayBuffer(2*e.length),r=new Uint16Array(t),i=0,n=e.length;i<n;i++)r[i]=e.charCodeAt(i);return r}}();